(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[383],{3693:function(e,t,a){Promise.resolve().then(a.bind(a,6371))},6371:function(e,t,a){"use strict";a.r(t);var n=a(6687),r=a(6840),i=a(5029),s=a(8965),l=a(4670),o=a(8648),c=a(7437),u=a(2265),d=a(4033),p=a(5391),m=a(2173);t.default=function(){var e,t,a,h,f=(0,l._)((0,u.useState)({title:"",publishing_year:"",file:"",editFile:""}),2),g=f[0],v=f[1],b=(0,d.useParams)(),y=(0,d.useRouter)(),x=(0,l._)((0,u.useState)(!1),2),j=x[0],_=x[1],N=(0,l._)((0,u.useState)({}),2),w=N[0],S=N[1],O=(e=(0,n._)(function(){var e,t;return(0,o.Jh)(this,function(a){return t=localStorage.getItem("userData")?JSON.parse(localStorage.getItem("userData")):"",_(!0),m.Z.post("/api/movies/".concat(b.id),{},{headers:{Authorization:"Bearer ".concat(null===(e=t)||void 0===e?void 0:e.token)}}).then(function(e){void 0==e.data.title&&y.push("/movies"),_(!1),v({title:e.data.title,publishing_year:e.data.publishing_year,file:"",editFile:e.data.poster?e.data.poster:""})}).catch(function(e){401==e.response.status&&(localStorage.setItem("userData",""),y.push("/")),S((0,s._)((0,i._)({},w),{common:e.response.data.error}))}),[2]})}),function(){return e.apply(this,arguments)});(0,u.useEffect)(function(){b.id&&O()},[]);var E=(t=(0,n._)(function(e){var t;return(0,o.Jh)(this,function(a){switch(a.label){case 0:if(e.preventDefault(),S({}),Object.keys(t=I()).length)return[2,S(t)];if(_(!0),!b.id)return[3,2];return[4,k()];case 1:return a.sent(),[3,4];case 2:return[4,C()];case 3:a.sent(),a.label=4;case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),D=function(e){v((0,s._)((0,i._)({},g),(0,r._)({},e.target.name,e.target.value)))},I=function(){var e={};return g.title||(e.title="Title is required."),g.publishing_year||(e.publishing_year="Publishing year is required."),g.file||g.editFile||(e.file="Image is required."),e},C=(a=(0,n._)(function(){var e,t,a;return(0,o.Jh)(this,function(n){return t=localStorage.getItem("userData")?JSON.parse(localStorage.getItem("userData")):"",(a=new FormData).append("title",g.title),a.append("publishing_year",g.publishing_year),a.append("file",g.file),a.append("action","add"),m.Z.post("/api/movies",a,{headers:{Authorization:"Bearer ".concat(null===(e=t)||void 0===e?void 0:e.token)}}).then(function(e){y.push("/movies")}).catch(function(e){401==e.response.status&&(localStorage.setItem("userData",""),y.push("/")),_(!1),S((0,s._)((0,i._)({},w),{common:e.response.data.error}))}),[2]})}),function(){return a.apply(this,arguments)});(0,n._)(function(){return(0,o.Jh)(this,function(e){switch(e.label){case 0:if(!window.confirm("Are you sure you want to delete this movie?"))return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,fetch("/api/movies/".concat(b.id),{method:"DELETE"})];case 2:return e.sent(),y.push("/movies"),y.refresh(),[3,4];case 3:return console.error(e.sent()),[3,4];case 4:return[2]}})});var k=(h=(0,n._)(function(){var e,t,a;return(0,o.Jh)(this,function(n){return t=localStorage.getItem("userData")?JSON.parse(localStorage.getItem("userData")):"",(a=new FormData).append("title",g.title),a.append("publishing_year",g.publishing_year),a.append("file",g.file),m.Z.put("/api/movies/".concat(b.id),a,{headers:{Authorization:"Bearer ".concat(null===(e=t)||void 0===e?void 0:e.token)}}).then(function(e){y.push("/movies")}).catch(function(e){401==e.response.status&&(localStorage.setItem("userData",""),y.push("/")),_(!1),S((0,s._)((0,i._)({},w),{common:e.response.data.error}))}),[2]})}),function(){return h.apply(this,arguments)}),F=function(){(localStorage.getItem("userData")?JSON.parse(localStorage.getItem("userData")):"")||y.push("/")};return(0,u.useEffect)(function(){F()},[]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"container",children:[(0,c.jsx)("nav",{className:"py-5 mb-2",children:(0,c.jsx)("div",{className:"px-10 md:px-0 mx-auto flex justify-between",children:(0,c.jsx)("div",{children:(0,c.jsx)("span",{className:"text-4xl font-bold",children:b.id?"Edit":"Create a new movie "})})})}),(0,c.jsxs)("div",{className:"row",children:[(0,c.jsxs)("div",{className:"col-sm-12 col-lg-6",children:[(0,c.jsxs)("label",{htmlFor:"fileUpload",className:"DragImage",children:[""==g.file&&""==g.editFile&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(p.VxU,{className:"display-6 mb-3"}),(0,c.jsx)("span",{className:"display-8 fw-bold",children:"Drag an image here "})]}),""!=g.file&&(0,c.jsx)("img",{width:"90%",src:URL.createObjectURL(g.file)}),""==g.file&&""!=g.editFile&&(0,c.jsx)("img",{width:"90%",src:"http://192.168.29.110:3000/uploads/"+g.editFile})]}),(0,c.jsx)("span",{className:"text-danger fw-bold",children:w.file?w.file:""}),(0,c.jsx)("input",{type:"file",style:{display:"none"},placeholder:"file",name:"file",id:"fileUpload",accept:"image/png, image/gif, image/jpeg",onChange:function(e){console.log(e.target.files),v((0,s._)((0,i._)({},g),(0,r._)({},e.target.name,e.target.files[0])))},className:"border-2 w-full p-4 rounded-lg my-4"})]}),(0,c.jsxs)("div",{className:"col-sm-12 col-lg-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("input",{type:"text",placeholder:"Title",name:"title",onChange:D,value:g.title,autoFocus:!0,className:"border-2 w-full p-4 rounded-lg my-4 InputFieldStyle mb-1"}),(0,c.jsx)("span",{className:"text-danger fw-bold",children:w.title?w.title:""})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("input",{name:"publishing_year",type:"number",placeholder:"Publishing year",onChange:D,value:g.publishing_year,className:"border-2 w-half p-4 d-block rounded-lg my-4 InputFieldStyle mb-1"}),(0,c.jsx)("span",{className:"text-danger fw-bold",children:w.publishing_year?w.publishing_year:""})]}),(0,c.jsx)("p",{children:w.common?w.common:""}),(0,c.jsxs)("div",{className:"mt-5 formSubmition",children:[(0,c.jsx)("span",{onClick:function(){return y.push("/movies")},className:"createEditCancelBtn",children:"Cancel"}),!0==j?(0,c.jsx)("span",{variant:"success",size:"lg",className:"ml-3 createEditSubmitBtn",children:b.id?"Updating":"Submiting"}):(0,c.jsx)("span",{onClick:E,variant:"success",size:"lg",className:"ml-5 createEditSubmitBtn",children:b.id?"Update":"Submit"})]})]})]})]}),(0,c.jsx)("div",{className:"bottomImageOnEdit"})]})}},1172:function(e,t,a){"use strict";a.d(t,{w_:function(){return o}});var n=a(2265),r={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},i=n.createContext&&n.createContext(r),s=function(){return(s=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},l=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]]);return a};function o(e){return function(t){return n.createElement(c,s({attr:s({},e.attr)},t),function e(t){return t&&t.map(function(t,a){return n.createElement(t.tag,s({key:a},t.attr),e(t.child))})}(e.child))}}function c(e){var t=function(t){var a,r=e.attr,i=e.size,o=e.title,c=l(e,["attr","size","title"]),u=i||t.size||"1em";return t.className&&(a=t.className),e.className&&(a=(a?a+" ":"")+e.className),n.createElement("svg",s({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,c,{className:a,style:s(s({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),o&&n.createElement("title",null,o),e.children)};return void 0!==i?n.createElement(i.Consumer,null,function(e){return t(e)}):t(r)}}}]);